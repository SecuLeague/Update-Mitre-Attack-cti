name: Update MITRE ATT&CK Data

on:
  schedule:
    - cron: "0 0 * * 1" # ExÃ©cute chaque lundi Ã  minuit UTC
  workflow_dispatch: # Permet de lancer manuellement

jobs:
  update_data:
    runs-on: ubuntu-latest

    steps:
      - name: ðŸ“¥ Cloner le repository
        uses: actions/checkout@v3

      - name: ðŸ›  Installer les dÃ©pendances
        run: |
          python -m venv venv
          source venv/bin/activate
          pip install pandas requests openpyxl stix2

      - name: ðŸ”„ TÃ©lÃ©charger et convertir MITRE ATT&CK JSON en Excel
        run: python update_attack_data.py

      - name: ðŸš€ Commiter et pousser les fichiers Excel mis Ã  jour
        run: |
          git config --global user.name "github-actions[bot]"
          git config --global user.email "github-actions[bot]@users.noreply.github.com"
          git add data/*.xlsx
          git commit -m "Mise Ã  jour des fichiers MITRE ATT&CK Excel ðŸ“Š" || echo "Pas de modifications Ã  commit"
          git push origin master
